<!DOCTYPE html>
<html>
<head>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; color: white; background: #212121; }
        .card { background: #333; padding: 15px; border-radius: 10px; margin-bottom: 10px; }
        button { background: #0088cc; color: white; border: none; padding: 10px; width: 100%; border-radius: 5px; }
    </style>
</head>
<body>
    <div id="profile" class="card">
        <h3>Профиль</h3>
        <p>ID: <span id="userId">...</span></p>
        <p>Баланс: <span id="balance">0</span> руб.</p>
    </div>

    <div class="card">
        <h3>Заказать услугу</h3>
        <input type="text" id="comment" placeholder="Комментарий к заказу" style="width: 90%; margin-bottom: 10px;">
        <button onclick="makeOrder(500)">Купить за 500 руб.</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        const serverUrl = "https://твой-сервер.com"; // URL где запущен Python бот
        const userId = tg.initDataUnsafe.user.id;

        document.getElementById('userId').innerText = userId;

        // Загрузка профиля
        fetch(`${serverUrl}/get_profile?user_id=${userId}`)
            .then(res => res.json())
            .then(data => {
                document.getElementById('balance').innerText = data.balance;
            });

        async function makeOrder(price) {
            const comment = document.getElementById('comment').value;
            const response = await fetch(`${serverUrl}/create_order`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ user_id: userId, price: price, comment: comment })
            });
            
            const result = await response.json();
            if (result.success) {
                alert("Заказ создан!");
                document.getElementById('balance').innerText = result.new_balance;
            } else {
                alert("Ошибка: " + result.error);
            }
        }
        tg.expand();
    </script>
</body>
</html>
