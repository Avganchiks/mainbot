<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: sans-serif; background: #1a1d21; color: white; margin: 0; padding: 15px; padding-bottom: 80px; }
        .page { display: none; }
        .active { display: block; }
        .card { background: #2b2f36; padding: 15px; border-radius: 12px; margin-bottom: 10px; border: 1px solid #3d434d; }
        .flex { display: flex; justify-content: space-between; align-items: center; }
        .price { color: #4CAF50; font-weight: bold; }
        button.buy { background: #2481cc; border: none; color: white; padding: 10px 15px; border-radius: 8px; font-weight: bold; }
        .tab-bar { position: fixed; bottom: 0; left: 0; width: 100%; background: #2b2f36; display: flex; justify-content: space-around; padding: 15px 0; border-top: 1px solid #444; }
        .tab { background: none; border: none; color: #888; font-size: 12px; font-weight: bold; }
        .tab.active { color: #2481cc; }
    </style>
</head>
<body>

    <div id="shop" class="page active">
        <h2 style="color: #2481cc;">üõí –ú–∞–≥–∞–∑–∏–Ω</h2>
        <div class="card flex">
            <div><b>–ê—Ä—Ö–∏–≤</b><br><span class="price">250‚ÇΩ</span></div>
            <button class="buy" onclick="sendOrder('–ê—Ä—Ö–∏–≤', 250)">–ó–∞–∫–∞–∑–∞—Ç—å</button>
        </div>
        <div class="card flex">
            <div><b>SEO</b><br><span class="price">130‚ÇΩ</span></div>
            <button class="buy" onclick="sendOrder('SEO', 130)">–ó–∞–∫–∞–∑–∞—Ç—å</button>
        </div>
        <div class="card flex">
            <div><b>–ó–∞–ª–∏–≤</b><br><span class="price">100‚ÇΩ</span></div>
            <button class="buy" onclick="sendOrder('–ó–∞–ª–∏–≤', 100)">–ó–∞–∫–∞–∑–∞—Ç—å</button>
        </div>
    </div>

    <div id="profile" class="page">
        <h2 style="color: #2481cc;">üë§ –ü—Ä–æ—Ñ–∏–ª—å</h2>
        <div class="card">
            <div class="flex" style="margin-bottom: 10px;"><span>–í–∞—à ID:</span> <span id="u_id">–ó–∞–≥—Ä—É–∑–∫–∞...</span></div>
            <div class="flex"><span>–ë–∞–ª–∞–Ω—Å:</span> <span id="u_bal" style="color: #4CAF50;">0‚ÇΩ</span></div>
        </div>
    </div>

    <div class="tab-bar">
        <button class="tab active" id="btn-shop" onclick="tab('shop')">–ú–ê–ì–ê–ó–ò–ù</button>
        <button class="tab" id="btn-profile" onclick="tab('profile')">–ü–†–û–§–ò–õ–¨</button>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        function tab(name) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(name).classList.add('active');
            document.getElementById('btn-' + name).classList.add('active');
        }

        function sendOrder(name, price) {
    // 1. –ë–µ—Ä–µ–º —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ (—É–±–∏—Ä–∞–µ–º —Å–∏–º–≤–æ–ª '‚ÇΩ' –∏ –ø–µ—Ä–µ–≤–æ–¥–∏–º –≤ —á–∏—Å–ª–æ)
    let currentBalElement = document.getElementById('u_bal');
    let currentBal = parseInt(currentBalElement.innerText.replace('‚ÇΩ', ''));

    // 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Ö–≤–∞—Ç–∏—Ç –ª–∏ –¥–µ–Ω–µ–≥ (–¥—É–±–ª–∏—Ä—É–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã)
    if (currentBal < price) {
        alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –±–∞–ª–∞–Ω—Å–µ!");
        return;
    }

    let comment = prompt("–í–≤–µ–¥–∏—Ç–µ —Å—Å—ã–ª–∫—É –∏–ª–∏ –¢–ó:");
    if (comment) {
        // 3. –í–ò–ó–£–ê–õ–¨–ù–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï: –≤—ã—á–∏—Ç–∞–µ–º —Å—É–º–º—É –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å
        let newBal = currentBal - price;
        currentBalElement.innerText = newBal + '‚ÇΩ';
        
        // –î–æ–±–∞–≤–∏–º –∞–Ω–∏–º–∞—Ü–∏—é (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ), —á—Ç–æ–±—ã —é–∑–µ—Ä –≤–∏–¥–µ–ª, —á—Ç–æ –±–∞–ª–∞–Ω—Å –∏–∑–º–µ–Ω–∏–ª—Å—è
        currentBalElement.style.color = "#ff4444"; 
        setTimeout(() => { currentBalElement.style.color = "#4CAF50"; }, 500);

        // 4. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É (–æ–Ω —Å–ø–∏—à–µ—Ç –¥–µ–Ω—å–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–π –±–∞–∑–µ)
        tg.sendData(JSON.stringify({
            service: name, 
            price: price, 
            comment: comment
        }));

        // –ï—Å–ª–∏ —Ö–æ—á–µ—à—å, —á—Ç–æ–±—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–∫—Ä—ã–≤–∞–ª–æ—Å—å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–∫–∞–∑–∞:
        // tg.close(); 
    }
}
    </script>
</body>
</html>

